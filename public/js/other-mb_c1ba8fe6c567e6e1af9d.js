(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{372:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"other-page",attrs:{mb:""}},[r("author-menu",{attrs:{drawerClass:"other-page",layout:"mb",active:e.query.a,user:e.user,"user-as-title":""}}),e._v(" "),r("div",{staticClass:"md"},[e.loading?r("Spin",{attrs:{fix:""}}):e._e(),e._v(" "),e.user?[r("div",{directives:[{name:"back-top",rawName:"v-back-top"}],ref:"scroll",staticClass:"reader-container"},[r("Reader",{ref:"reader",attrs:{"user-preview":e.user.preview},on:{"on-after":e.onAfter}})],1)]:e._e()],2)],1)};s._withStripped=!0;var a=r(221),n=r(415),i=r(399),u={mixins:[n.a],components:{Reader:i.a,AuthorMenu:a.a}},o=(r(448),r(3)),c=Object(o.a)(u,s,[],!1,null,null,null);c.options.__file="src/other/mb.vue";t.default=c.exports},415:function(e,t,r){"use strict";var s,a,n,i,u=r(4),o=r.n(u),c=r(10),d=r.n(c),h=r(1);t.a={data:function(){return{loading:!1,myself:!1,query:h.a.util.query2Json(),note:null,user:null,mode:"read"}},mounted:(i=d()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.query.u&&["link","contact"].includes(this.query.a)?this.loadPageUser():this._open404("缺少参数n或a");case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),computed:{md:function(){var e="";return this.user&&this.query.a&&(e=this.user.page[this.query.a]),e},preview:function(){return this.$store.state.preview},placeholder:function(){return"link"===this.query.a?"请编辑友情链接！":"contact"===this.query.a?"请编辑联系方式！":void 0}},methods:{doReaderPreview:function(){var e=this;this.$nextTick((function(){e.$refs.reader&&e.$refs.reader.doPreview(e.md)}))},onSave:(n=d()(o.a.mark((function e(t){var r,s,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.query.u,s=this.query.a,e.next=4,h.a.blog.savePage({userId:r,key:s,md:t});case 4:return a=e.sent,0===(n=a.code)&&this._messageSuccess("保存成功"),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)}),saveAndPreview:(a=d()(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,t=this.$refs.editor.getValue(),e.next=4,this.onSave(t);case 4:0===e.sent&&(r=this.query.a,this.mode="read",this.user.page[r]=t,this.doReaderPreview());case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)}),onAfter:function(){this.loading=!1},loadPageUser:(s=d()(o.a.mark((function e(){var t,r,s,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.query.u,r=this.query.a,this.loading=!0,e.next=5,h.a.blog.getUser({userId:t,key:r});case 5:s=e.sent,a=s.code,n=s.data,0===a&&(n?(this.user=n.user,this.myself=n.myself,this.doReaderPreview()):this._open404(msg));case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})}}},417:function(e,t,r){},448:function(e,t,r){"use strict";var s=r(417);r.n(s).a}}]);